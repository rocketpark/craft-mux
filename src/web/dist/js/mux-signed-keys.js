import{d as e,o as t,c as n,a as s,z as i,w as a,u as l,t as o,F as d,p as r,n as c,k as u,l as g,s as y}from"./vue.esm-bundler.js";const p=e({signedkeys:[],loading:!1,params:{limit:50,page:1}});function k(){p.loading=!0;const e=new URLSearchParams(p.params).toString();fetch(`/actions/mux/signing-keys/list-signed-keys?${e}`).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{p.signedkeys=e,p.loading=!1})).catch((e=>{p.loading=!1,console.error("There was a problem with the fetch operation:",e)}))}const h=["data-id"],x={class:"singleline-cell textual"},f={style:{display:"flex","justify-content":"space-between","align-items":"center",gap:"16px","text-align":"left",padding:"3px 8px",width:"100%"}},m=["textContent"],b={style:{width:"18px",height:"18px"},xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512"},w={class:"singleline-cell textual"},v=["textContent"],C={class:"singleline-cell",style:{width:"200px"}},S=["textContent"],T={class:"thin action"},_=["disabled","aria-label"],j={__name:"MuxSignedKeysRow",props:{idx:{type:Number,default:null},signedkey:{type:Object,default:{id:null,key_id:null,created_at:null,private_key:null}}},setup(e){const o=e,d=()=>{(function(e){p.loading=!0;const t={signed_key_id:e};return t[window.Craft.csrfTokenName]=window.Craft.csrfTokenValue,fetch("/actions/mux/signing-keys/delete-signed-key",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.ok?(p.loading=!1,e.json()):Promise.reject(new Error(`HTTP error ${e.status}`)))).catch((e=>(p.loading=!1,Promise.reject(e))))})(o.signedkey.key_id).then((e=>{Craft.cp.displayNotice(Craft.t("mux","Private Key Deleted.")),k()}))},r=()=>{navigator.clipboard.writeText(o.signedkey.private_key).then((()=>{Craft.cp.displayNotice(Craft.t("mux","Private Key Copied."))}))},c=e=>{const t=new Date(1e3*e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`};return(o,u)=>{return t(),n("tr",{"data-id":e.idx},[s("td",x,[s("div",f,[s("div",{class:"",style:{"font-family":"monospace","user-select":"all","word-break":"break-all"},textContent:i((g=e.signedkey.private_key,y=57,g.length>y?`${g.substring(0,y)}â€¦`:g))},null,8,m),s("button",{class:"copy icon",style:{"justify-self":"flex-end"},title:"Copy Private Key",onClick:a(r,["prevent"])},[(t(),n("svg",b,u[0]||(u[0]=[s("path",{d:"M280 64h40c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128C0 92.7 28.7 64 64 64h40 9.6C121 27.5 153.3 0 192 0s71 27.5 78.4 64H280zM64 112c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H320c8.8 0 16-7.2 16-16V128c0-8.8-7.2-16-16-16H304v24c0 13.3-10.7 24-24 24H192 104c-13.3 0-24-10.7-24-24V112H64zm128-8a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"},null,-1)])))])])]),s("td",w,[s("div",{class:"",style:{"font-family":"monospace",padding:"3px 8px","text-align":"left","user-select":"all","word-break":"break-all"},textContent:i(e.signedkey.key_id)},null,8,v)]),s("td",C,[s("div",{class:"",textContent:i(c(e.signedkey.created_at))},null,8,S)]),s("td",T,[s("button",{class:"delete icon",title:"Delete",type:"button",disabled:l(p).loading,"aria-label":`Delete signed key ${e.idx+1}`,onClick:a(d,["prevent"])},null,8,_)])],8,h);var g,y}}},K={id:"settings-muxSignedKeys-field",class:"field","data-attribute":"muxSignedKeys"},P={class:"input ltr"},N={id:"settings-muxSignedKeys",class:"editable fullwidth",style:{}},H=["aria-disabled","disabled"],O={key:0},V={key:1,class:"spinner spinner-absolute"};y({__name:"MuxSignedKeys",setup(e){const i={id:null,key_id:null,created_at:null,private_key:null},y=o((()=>p.loading?"btn dashed mux-w-full loading":"btn dashed mux-w-full add icon"));k();const h=()=>{(function(e){p.loading=!0;const t={request:e};return t[window.Craft.csrfTokenName]=window.Craft.csrfTokenValue,fetch("/actions/mux/signing-keys/create-signed-key",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.ok?(p.signedkeys=e.data,p.loading=!1,e.json()):Promise.reject(new Error(`HTTP error ${e.status}`)))).catch((e=>(p.loading=!1,Promise.reject(e))))})({referrer:i.referrer}).then((e=>{Craft.cp.displayNotice(Craft.t("mux","Private Key Created.")),k()}))};return(e,i)=>(t(),n("div",K,[i[2]||(i[2]=s("div",{id:"settings-muxSignedKeys-instructions",class:"instructions"},[s("div",null," Signing keys are used to sign JSON Web Tokens (JWTs) for securing certain requests, such as secure playback URLs and access to real-time viewer counts in Mux Data. One signing key can be used to sign multiple requests - you probably only need one active at a time. However, you can create multiple signing keys to enable key rotation, creating a new key and deleting the old only after any existing signed requests have expired. ")],-1)),i[3]||(i[3]=s("br",null,null,-1)),s("div",P,[s("table",N,[i[0]||(i[0]=s("colgroup",null,[s("col"),s("col"),s("col"),s("col")],-1)),i[1]||(i[1]=s("thead",null,[s("tr",null,[s("th",{id:"settings-muxSignedKeys-heading-1",scope:"col",class:"singleline-cell textual has-info"}," Private Key "),s("th",{id:"settings-muxSignedKeys-heading-3",scope:"col",class:"singleline-cell has-info"}," Key Id "),s("th",{id:"settings-muxSignedKeys-heading-2",scope:"col",style:{width:"200px"},class:"singleline-cell has-info"}," Created At "),s("th",{colspan:"1",scope:"colgroup"},[s("span",{class:"visually-hidden"},"Row actions")])])],-1)),s("tbody",null,[(t(!0),n(d,null,r(l(p).signedkeys,((e,n,s)=>(t(),g(j,{key:s,idx:n,signedkey:e},null,8,["idx","signedkey"])))),128))])]),s("button",{type:"button",class:c(y.value),"aria-label":"Add signed key",style:{opacity:"1","pointer-events":"auto"},"aria-disabled":l(p).loading,tabindex:"0",disabled:l(p).loading,onClick:a(h,["prevent"])},[l(p).loading?u("",!0):(t(),n("span",O,"Add signed key")),l(p).loading?(t(),n("div",V)):u("",!0)],10,H)])]))}}).mount("#mux-signed-keys");
